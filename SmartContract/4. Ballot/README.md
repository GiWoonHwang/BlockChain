전자 민주주의 문제
전자 민주주의란 인도의 간단한 디지털 신분 카드에서부터 에스토니아의 전자 영주권에 이르기까지 매우 다양한 것을 포함한다.
인터넷 기반 통신이나 정보 시스템 같은 디지털화를 통한 전자 민주주의, 특히 종이 투표나 기계 대신 인터넷 기반 전자 투표에 관해 알아본다.

문제 설정 : 온라인 투표 시스템을 기획해 보자. 사람들은 다수의 제안 가운데 하나에만 투표한다. 의장은 투표할 수 있는 사람을 등록하고, 오직 등록된 사람만이
               제안 선택지 중 하나에 투표(한번)한다. 의장의 표는 가중치를 주어서 두 표로 계산한다. 투표 과정은 네 개의 상태(Init, Regs, Vote, Done)를 거치며,
	      이 상태에 따라 각각 다른 오퍼레이션(initialize, register, vote, count votes)을 수행한다.

솔루션 설계
1. 유스케이스 다이어그램을 이용해 사용자, 데이터 애셋, 트랜잭션 식별
2. 데이터, 수정자, 확인과 검증을 위한 규칙, 함수를 정의하는 컨트랙트 다이어그램을 설계
3. 솔리디티로 스마트 컨트랙트 개발
4. 리믹스 IDE에서 스마트 컨트랙트를 컴파일하고, 배포, 테스트
++ 투표 문제는 유한 상태 머신(Finite State Machinc)라는 다이어그램이 추가되는데, 투표 과정의 각 단계를 포함한다

이 케이스에서 데이터 애셋은 투표자들이 투표할 제안들이다. 또한 투표자들이 투표했는지 여부와 투표의 가중치를 관리하는 것도 필요하다. (의장은 투표자 이기도 하고, 가중치=2 를 갖는다는 점을 상기)
문제 설정에서 정의한 투표의 단계를 열거 데이터 타입인 enum으로 코딩한다. enum은 솔리디티가 제공하는 내부 데이터 타입이다. Voter 타입과 Proposal 타입은 struct 구조체를 이용해 정의했으며,
특수한 투표자인 chairperson도 정의했다. mapping 데이터 구조는 투표 어카운트 주소자를 투표자 상세 정보에 매핑하고, 투표할 대상인 제안들(숫자들)을 담는 배열도 정의했다.

규칙
- 등록은 투표 전에 마쳐야 하고, 특정한 종료 시간 전에 이루어져야 한다.
- 투표 과정을 위한 함수는 특정한 순서에 따라 실행한다.
- 투표는 오직 정해진 기간만 가능하다.
- 투표가 종료되어야만 승자를 판단할 수 있다.

스토리지 vs 메모리
vote 함수를 살펴보면 솔리티에서는 변수는 storage(지속되고 블록에 보관) 또는 memory(일시적이고 블록에 저장되지 않음)로 정의할 수 있다. 기본적으로 간단한 변수는 momory 타입인 데다 임시적이므로 블록에 저장되지 않는다.
struct 데이터 구조는 디폴트로 storage 변수이기 때문에 이것을 사용할 때는 변수를 선언해 줄 필요가 있다.

함수 상세 설명
constructor() - 스마트 컨트랙트를 배포할 때 이 함수를 호출한다. 컨트랙트를 배포하는 어카운트의 주소는 의장의 것이다. 이 함수는 파라미터로 투표할 제안의 수를 받는다. 데이터 요소들과 투표 상태를 초기화 한다.

changeState() - 투표 상태를 매칭하는 상태로 변화시킨다. 오직 의장만이 실행할 수 있고 파라미터는 올바른 순서가 되어야 한다.

register() - 오직 의장만이 실행할 수 있다. 

vote() - 이 함수는 오직 투표 단계에서만 실행할 수 있다. 이 규칙은 수정자에 의해 강제된다. (투표 시기가 끝나면 의장에 의해서 state는 Phase.Done으로 바뀐다.)

reqWinner() - 이 함수는 투표를 집계하고 투표수로 어느 제안이 승리했는지 식별한다. 이 함수는 체인에 기록되지 않는다 view 함수이다

수정자
수정자는 스마트 컨트랙트에서 확인과 검증 구현을 위한 솔리디티의 특수한 프로그래밍 언어 구조이다. 
- 이름과 파라미터를 가진 헤더 라인이 있다.
- require 문 안에 체크해야 할 조건들을 명시하는 본문이 있다
- _; 라인이 있는데, 이것은 수정자의 조건을 통과하고 난 후 실행해야 할 코드를 나타낸다.

요약
1. 블록체인 기반 어플리케이션에서 신뢰는 세 가지 기능 ( 수정자, require, assert)을 이용한 확인, 검증을 통해 확립된다
2. revert() 선언은 함수 호출을 되돌리고, 트랜잭션이 블록체인의 변조 불가능 장부에 기록되는 것을 막는다


